import{u as P,r as y,a as S,j as e,B as f,b as C,F as h,N as a,c as W,S as $,d as B,e as v,f as G}from"./index-0e5b1f2e.js";function V({Project:i,setProject:k,validId:b,setProjects:t}){const{state:p,dispatch:E}=P(),[n,N]=y.useState(""),F=x=>N(x.target.value);async function w(){if(i){let x=n.split(`
`);const T=x.length+i.task.length,o=Math.round(100/T),d=x.map(r=>({completed:!1,content:r,points:o})),g=i.task.filter(r=>r.points=o).concat(d),j=g.filter(r=>r.completed).length;let m=0,u=0;for(;m<j;)u+=o,m++;const s={name:i.name,description:i.description,progress:u,target:i.target,task:g};await h(`api/projects/${b}`,"PUT",s).then(r=>{"error"in r?a("Fetch Error",r.error):k(r)}).catch(r=>a("Error While Fetching Project Details",r.message)),await h(`api/projects/${b}`,"GET").then(r=>{"error"in r?a("Fetch Error",r.error):k(r)}).catch(r=>a("Error While Fetching Project Details",r.message)),await h("api/projects","GET").then(r=>{"error"in r?a("Fetch Error",r.error):t(r)}).catch(r=>a("Error While Fetching Project Details",r.message)),E({type:"addTask",payload:{addTask:!1}})}}return S.createPortal(e.jsx("section",{className:`${p.theme}`,children:e.jsxs("form",{className:"w-4/5 md:w-3/5 lg:w-1/2 h-3/5 absolute z-20 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-slate-100 dark:bg-slate-600 rounded-3xl p-3 shadow-2xl",children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx("p",{className:" dark:text-white font-bold text-3xl tracking-wider",children:"New Task"}),e.jsx(f,{Value:C,bg:"bg-red-500",more:"text-white text-3xl p-1 rounded-xl absolute top-0 right-2",onClick:()=>E({type:"addTask",payload:{addTask:!1}}),modal:!0})]}),e.jsxs("div",{className:"flex flex-col w-11/12 mx-auto pt-5 gap-4 md:gap-2",children:[e.jsx("textarea",{id:"task",value:n,onChange:F,placeholder:"Project Task ( Press Enter To Split The Task )",className:"h-40 rounded-xl text-gray-600 placeholder:text-gray-500 placeholder:text-lg text-xl font-semibold dark:focus:outline-slate-500 hover:border-gray-500 px-2 "}),n?e.jsx(f,{Value:"Submit",bg:"bg-blue-500 text-white hover:bg-blue-400",more:"font-bold tracking-widest text-xl",modal:!0,onClick:w}):e.jsxs(e.Fragment,{children:[e.jsx(f,{Value:"Submit",bg:"bg-blue-500 text-white hover:bg-blue-400",more:"font-bold tracking-widest text-xl",modal:!0}),e.jsx("p",{className:"text-center text-xl dark:text-white text-slate-600",children:"Task Must Not Be Empty!"})]})]})]})}),document.getElementById("modal"))}function U({setProjects:i}){var T;const{state:k,dispatch:b}=P(),[t,p]=y.useState(null),n=(T=W().id)==null?void 0:T.split("S")[0];y.useEffect(()=>{h(`api/projects/${n}`,"GET").then(o=>{"error"in o?a("Fetch Error",o.error):p(o)}).catch(o=>a("Error While Fetching Project Details",o.message))},[]);const N=async(o,d)=>{if(o.preventDefault(),t){const c=t.task[d];c.completed=!0;const g=t.task.filter(s=>s.completed).length;let j=0,m=0;for(;j<g;)m+=c.points,j++;const u={name:t.name,description:t.description,progress:m,target:t.target,task:t.task};await h(`api/projects/${n}`,"PUT",u).then(s=>{"error"in s?a("Fetch Error",s.error):p(s)}).catch(s=>a("Error While Fetching Project Details",s.message)),await h(`api/projects/${n}`,"GET").then(s=>{"error"in s?a("Fetch Error",s.error):p(s)}).catch(s=>a("Error While Fetching Project Details",s.message)),await h("api/projects","GET").then(s=>{"error"in s?a("Fetch Error",s.error):i(s)}).catch(s=>a("Error While Fetching Project Details",s.message))}},F=async(o,d)=>{if(t){const c=t.task.filter((l,D)=>D!==d),g=Math.round(100/c.length),j=c.filter(l=>l.points=g),m=c.filter(l=>l.completed).length;let u=0,s=0;for(;u<m;)s+=g,u++;const r={name:t.name,description:t.description,progress:s,target:t.target,task:j};await h(`api/projects/${n}`,"PUT",r).then(l=>{"error"in l?a("Fetch Error",l.error):p(l)}).catch(l=>a("Error While Fetching Project Details",l.message)),await h(`api/projects/${n}`,"GET").then(l=>{"error"in l?a("Fetch Error",l.error):p(l)}).catch(l=>a("Error While Fetching Project Details",l.message)),await h("api/projects","GET").then(l=>{"error"in l?a("Fetch Error",l.error):i(l)}).catch(l=>a("Error While Fetching Project Details",l.message))}};let w=null;t&&(w=new Date(t.createdAt).toDateString());const x="bg-slate-500 hover:bg-blue-500 hover:dark:bg-blue-500 text-white";return e.jsxs("section",{className:"flex flex-col gap-3",children:[t===null&&e.jsx($,{}),t&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center text-2xl font-bold",children:t.name}),e.jsx("h2",{className:"text-center text-xl font-semibold",children:t.description}),e.jsxs("h3",{className:"relative text-center text-base tracking-wide font-semibold",children:["Tasks",e.jsx("div",{className:"absolute top-0 right-0",children:e.jsx(f,{Value:B,bg:x,more:" text-lg p-1",onClick:()=>b({type:"addTask",payload:{addTask:!0}})})})]}),e.jsx("ul",{className:"flex flex-col gap-2",children:t==null?void 0:t.task.map((o,d)=>e.jsxs("li",{className:` ${o.completed?"opacity-60 line-through":""} grid grid-cols-3 w-full`,children:[e.jsx("p",{className:"w-full col-span-2 whitespace-pre-line",children:o.content}),e.jsxs("div",{className:"flex gap-1 justify-end",children:[o.completed?e.jsx(f,{Value:v,bg:x,more:"p-1 text-xl"}):e.jsx(f,{Value:v,bg:x,more:"p-1 text-xl",onClick:c=>N(c,d)}),e.jsx(f,{Value:G,bg:"bg-slate-500 hover:bg-blue-500 hover:dark:bg-blue-500 text-white",more:"p-1 text-xl",onClick:c=>F(c,d)})]})]},d))}),e.jsx("div",{className:"w-full h-2 rounded-xl dark:bg-white",children:e.jsx("div",{style:{width:`${t.progress}%`},className:"h-full rounded-xl bg-blue-500"})}),e.jsxs("p",{className:"text-center text-2xl font-bold",children:[t.progress,"%"]}),e.jsx("div",{className:"text-center text-lg",children:w})]}),k.addTask&&e.jsx(V,{Project:t,setProject:p,setProjects:i,validId:n})]})}export{U as default};
